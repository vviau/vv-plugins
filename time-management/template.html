<div>
   <div class="row">
      <div class="col-md-12">
         <uib-tabset active="activeTab">
            <uib-tab index="0" heading="1. Dimension">
               <div class="toolbar">
                  <div class="page-title">
                     <h3 translate="TM-Step1Title">
                     </h3>
                     <h5 translate="TM-Step1SubTitle">
                     </h5>
                  </div>
                  <div class="pull-right">
                     <button type="button" class="btn btn-secondary" ng-click="setActiveTab(1);checkIfDimensionExist();generateAttributesExamples()"
                        translate="TM-Step1Next"></button>
                     <button type="button" class="btn btn-success" ng-click="setActiveTab(3);generateDimensionInfo();checkIfDimensionExist();generateAttributesExamples()"
                        translate="TM-ReviewAndCreate"></button>
                  </div>
               </div>
               <div class="row mt-3">
                  <div class="col-md-6">
                     <div class="card">
                        <div class="card-header" style="padding: 5px 10px;">
                           <i class="fa dimensions"></i> <label translate="DIMENSION">
                              :
                           </label>
                        </div>
                        <div class="card-body">
                           <div class="row">
                              <div class="col-md-4 text-right">
                                 <label translate="NAME"></label>:
                              </div>
                              <div class="col-md-8">
                                 <input type="text" class="form-control" ng-model="selections.dimensionName"
                                    uib-typeahead="dimension.Name for dimension in lists.dimensions | filter:$viewValue | limitTo:20"
                                    typeahead-append-to-body="true" />
                              </div>
                           </div>
                           <div class="row mt-2">
                              <div class="col-md-4 text-right">
                                 <label translate="TM-LEAFS"></label>:
                              </div>
                              <div class="col-md-8">
                                 <select class="form-control input-group-append" ng-model="selections.dimensionType"
                                    ng-options="t for t in lists.dimensionTypes" ng-change="updateDatePicketFormat()">
                                    <option></option>
                                 </select>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="col-md-6">
                     <div class="card">
                        <div class="card-header" style="padding: 5px 10px;">
                           <i class="fa fa-calendar"></i>
                           <label translate="TM-CALENDAR">
                              :
                           </label>
                        </div>
                        <div class="card-body">
                           <div class="row mt-1">
                              <div class="col-md-6 text-right">
                                 <label translate="TM-FROM">:</label>
                              </div>
                              <div class="col-md-6">
                                 <span class="input-group" uib-dropdown is-open="startTimeIsOpen">
                                    <span type="text" class="form-control">
                                       {{selections.dateRangeStart | amDateFormat:'DD-MM-YYYY'}}
                                    </span>
                                    <span class="input-group-append">
                                       <button id="dropdownStartTime" type="button" class="btn btn-secondary"
                                          uib-dropdown-toggle>
                                          <span class="fa fa-calendar"></span>
                                       </button>
                                       <span class="dropdown-menu" uib-dropdown-menu>
                                          <datetimepicker ng-model="selections.dateRangeStart" datetimepicker-config="{modelType:'moment', startView:'day', minView:'day'}"
                                             on-set-time="startTimeIsOpen=!startTimeIsOpen" />
                                       </span>
                                    </span>
                                 </span>
                              </div>
                           </div>
                           <div class="row mt-1">
                              <div class="col-md-6 text-right">
                                 <label translate="TM-TO">:</label>
                              </div>
                              <div class="col-md-6">
                                 <span class="input-group" uib-dropdown is-open="endTimeIsOpen">
                                    <span type="text" class="form-control">
                                       {{selections.dateRangeEnd | amDateFormat:'DD-MM-YYYY'}}
                                    </span>
                                    <span class="input-group-append">
                                       <button id="dropdownEndTime" type="button" class="btn btn-secondary"
                                          uib-dropdown-toggle>
                                          <span class="fa fa-calendar"></span>
                                       </button>
                                       <span class="dropdown-menu" uib-dropdown-menu>
                                          <datetimepicker ng-model="selections.dateRangeEnd" datetimepicker-config="{modelType:'moment', startView:'day', minView:'day'}"
                                             on-set-time="endTimeIsOpen=!endTimeIsOpen" />
                                       </span>
                                    </span>
                                 </span>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </uib-tab>
            <uib-tab index="1">
               <uib-tab-heading>
                  2. {{selections.hierarchiesOrRollUps}}
               </uib-tab-heading>
               <auto-height>
                  <div class="toolbar">
                     <div class="page-title">
                        <h3>
                           <span translate="TM-Step2Title"></span>
                           <div class="form-check-inline">
                              <div class="radio ml-1">
                                 <input ng-model="selections.hierarchiesOrRollUps" type="radio" name="optionH" ng-value="'Hierarchies'">
                                 Hierarchies
                              </div>
                              <div class="radio ml-1">
                                 <input ng-model="selections.hierarchiesOrRollUps" type="radio" name="optionR" ng-value="'RollUps'">
                                 RollUps
                              </div>
                           </div>
                        </h3>

                        <h5 translate="TM-Step2SubTitle">

                        </h5>
                     </div>
                     <div class="pull-right">
                        <button type="button" class="btn btn-secondary" ng-click="setActiveTab(0)" translate="TM-Step2Previous"></button>
                        <button type="button" class="btn btn-secondary" ng-click="setActiveTab(2)" translate="TM-Step2Next"></button>
                        <button type="button" class="btn btn-success" ng-click="setActiveTab(3);generateDimensionInfo()"
                           translate="TM-ReviewAndCreate"> <span></span></button>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-md-6">
                        <div class="card">
                           <div class="card-header" style="padding: 5px 10px;">
                              <label>All {{selections.dimensionType}} {{selections.hierarchiesOrRollUps}}</label>
                           </div>
                           <div class="card-body">
                              <div ng-repeat="hierarchy in lists.hierarchyTypes[selections.dimensionType] track by $index"
                                 class="badge ml-1" ng-style="generateHSLColour(hierarchy.type)" style="cursor:pointer"
                                 ng-click="addHierarchy(hierarchy.type)" title="{{hierarchy.desc}}">
                                 <span style="font-size:1.2em">
                                    <i class="fa fa-plus-circle"></i> {{hierarchy.shortDesc}}
                                 </span>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="col-md-6">
                        <div class="card">
                           <div class="card-header" style="padding: 5px 10px;">
                              <label translate="ALIAS"></label><i class="fa fa-fw fa-plus-circle text-success" ng-click="addAlias(aliases.length)"
                                 style="cursor:pointer"></i>
                           </div>
                           <div class="card-body">
                              <div class="row">
                                 <div class="col-md-4 mt-1" ng-repeat="alias in aliases track by $index">
                                    <span class="input-group">
                                       <input type="text" class="form-control input-group-prepend" ng-model="alias.name" />
                                       <span class="input-group-append">
                                          <button class="btn btn-danger" title="Delete" ng-click="removeAlias($index)">
                                             <i class="fa fa-fw fa-trash"></i>
                                          </button>
                                       </span>
                                    </span>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-md-6 mt-2" ng-class="{'col-md-12':aliases.length>1}" ng-repeat="hierarchy in hierarchies track by $index">
                        <div class="card">
                           <div class="card-header">
                              <span class="input-group">
                                 <span class="input-group-prepend input-group-text" translate="NAME">:
                                 </span>
                                 <input type="text" class="form-control input-group-append" ng-model="hierarchy.name" />
                                 <span class="input-group-append input-group-text" translate="TM-PARENT">:
                                 </span>
                                 <input type="text" class="form-control input-group-append" ng-model="hierarchy.levels[0].name" />
                                 <span class="input-group-append">
                                    <button class="btn btn-danger" title="Delete" ng-click="removeHierarchy($index)">
                                       <i class="fa fa-fw fa-trash"></i>
                                    </button>
                                 </span>
                                 <span class="input-group-append">
                                    <button ng-if="hierarchy.display" class="btn btn-info" title="Hide" ng-click="hierarchy.display=false">
                                       <i class="fa fa-fw fa-eye-slash"></i>
                                    </button>
                                    <button ng-if="!hierarchy.display" class="btn btn-info" title="Show" ng-click="hierarchy.display=true">
                                       <i class="fa fa-fw fa-eye"></i>
                                    </button>
                                 </span>
                              </span>
                           </div>
                           <div class="card-body p-2" ng-if="hierarchy.display">
                              <table class="table table-hover table-sm">
                                 <thead>
                                    <tr>
                                       <th> </th>
                                       <th class="text-center" translate="LEVEL"></th>
                                       <th class="text-center" translate="ELEMENT"></th>
                                       <th class="text-center" ng-repeat="alias in aliases track by $index">
                                          {{alias.name}}
                                       </th>
                                    </tr>
                                 </thead>
                                 <tbody>
                                    <tr ng-repeat="element in hierarchy.levels" ng-if="$index != 0">
                                       <td>
                                          <a href class="click" ng-click="element.included = !element.included" ng-if="element.level!=selections.dimensionType">
                                             <i class="fa fa-toggle-on text-success" ng-if="element.included"></i>
                                             <i class="fa fa-toggle-off" ng-if="!element.included"></i>
                                          </a>
                                       </td>
                                       <td>
                                          {{element.level}}
                                       </td>
                                       </td>
                                       <td>
                                          <span class="input-group" ng-if="element.included">
                                             <span class="col-md-6">
                                                <input class="form-control ng-pristine ng-untouched ng-valid ng-empty"
                                                   style="border-radius:0;display:inline" type="text" ng-model="lists.dateFormats[element.level].format"
                                                   placeholder="" ng-keydown="key($event,selection.cube)" uib-typeahead="type for type in lists.dateFormats[element.level].formats | filter:$viewValue | limitTo:20"
                                                   typeahead-append-to-body="true" ng-change="generateExample();generateDimensionInfo()">
                                             </span>
                                             <span class="col-md-6">
                                                {{examples[element.level]}}
                                             </span>
                                          </span>
                                       </td>
                                       <td ng-repeat="alias in aliases">
                                          <span class="input-group" ng-if="element.included">
                                             <span class="col-md-6">
                                                <input class="form-control ng-pristine ng-untouched ng-valid ng-empty"
                                                   style="border-radius:0;display:inline" type="text" ng-model="alias.format[element.level].format"
                                                   placeholder="" ng-keydown="key($event,selection.cube)" uib-typeahead="type for type in lists.dateFormats[element.level].format | filter:$viewValue | limitTo:20"
                                                   typeahead-append-to-body="true" ng-change="generateExample();generateDimensionInfo();generateExampleAlias($index)">
                                             </span>
                                             <span class="col-md-6">
                                                {{alias.examples[element.name]}}
                                             </span>
                                          </span>
                                       </td>
                                    </tr>
                                 </tbody>
                              </table>
                              <div class="row mt-1" ng-if="hierarchy.type == 'CalendarMonth'">
                                 <div class="col-md-12" ng-if="hierarchy.levels[2].included || hierarchy.levels[3].included">
                                    <label>
                                       Manage Roll-ups (<a href class="click" ng-click="selections.manageRollsUpsManually = !selections.manageRollsUpsManually">
                                          <i class="fa fa-toggle-on text-success" ng-if="selections.manageRollsUpsManually"></i>
                                          <i class="fa fa-toggle-off" ng-if="!selections.manageRollsUpsManually"></i>
                                       </a> Custom):
                                    </label>
                                    <table class="table table-hover table-responsive">
                                       <thead>
                                          <tr>
                                             <th ng-repeat="month in lists.months"> {{month}} </th>
                                          </tr>
                                       </thead>
                                       <tbody>
                                          <tr ng-if="hierarchy.levels[2].included">
                                             <td ng-repeat="month in lists.months">
                                                <h5><span class="badge badge-pill" ng-class="{'badge-primary':lists[month].HalfYear==1,
                                                                  'badge-success':lists[month].HalfYear==2}"
                                                      style="cursor:pointer" ng-click="updateMonthConso('HalfYear', month, selections.manageRollsUpsManually)">
                                                      H{{lists[month].HalfYear}}
                                                   </span></h5>
                                             </td>
                                          </tr>
                                          <tr ng-if="hierarchy.levels[3].included">
                                             <td ng-repeat="month in lists.months">
                                                <h5><span class="badge badge-pill" ng-class="{'badge-primary':lists[month].Quarter==1,
                                                                     'badge-secondary':lists[month].Quarter==2,
                                                                     'badge-success':lists[month].Quarter==3,
                                                                     'badge-info':lists[month].Quarter==4}"
                                                      style="cursor:pointer" ng-click="updateMonthConso('Quarter',month, selections.manageRollsUpsManually)">
                                                      Q{{lists[month].Quarter}}
                                                   </span></h5>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </div>
                              </div>
                              <div class="row mt-1" ng-if="hierarchy.type == 'CalendarWeek'">
                                 <div class="col-md-6 text-right">
                                    <label translate="TM-FirstWeekDay">
                                       :
                                    </label>
                                 </div>
                                 <div class="col-md-6 text-center">
                                    <select class="form-control input-group-append" ng-model="selections.startDayofWeek"
                                       ng-options="t for t in lists.weekDays">
                                       <option></option>
                                    </select>
                                 </div>
                              </div>
                              <div class="row mt-1" ng-if="hierarchy.type == 'CalendarFY'">
                                 <div class="col-md-12" ng-if="hierarchy.levels[2].included || hierarchy.levels[3].included">
                                    <label>
                                       Manage Roll-ups (<a href class="click" ng-click="selections.manageRollsUpsManually = !selections.manageRollsUpsManually">
                                          <i class="fa fa-toggle-on text-success" ng-if="selections.manageRollsUpsManually"></i>
                                          <i class="fa fa-toggle-off" ng-if="!selections.manageRollsUpsManually"></i>
                                       </a> Custom):
                                    </label>
                                    <table class="table table-hover table-responsive">
                                       <thead>
                                          <tr>
                                             <th ng-repeat="month in lists.months"> {{month}} </th>
                                          </tr>
                                       </thead>
                                       <tbody>
                                          <tr ng-if="hierarchy.levels[2].included">
                                             <td ng-repeat="month in lists.months">
                                                <h5><span class="badge badge-pill" ng-class="{'badge-primary':lists[month].HalfYearFY==1,
                                                                     'badge-success':lists[month].HalfYearFY==2}"
                                                      style="cursor:pointer" ng-click="updateMonthConso('HalfYearFY', month, selections.manageRollsUpsManually)">
                                                      H{{lists[month].HalfYearFY}}
                                                   </span></h5>
                                             </td>
                                          </tr>
                                          <tr ng-if="hierarchy.levels[3].included">
                                             <td ng-repeat="month in lists.months">
                                                <h5><span class="badge badge-pill" ng-class="{'badge-primary':lists[month].QuarterFY==1,
                                                                        'badge-secondary':lists[month].QuarterFY==2,
                                                                        'badge-success':lists[month].QuarterFY==3,
                                                                        'badge-info':lists[month].QuarterFY==4}"
                                                      style="cursor:pointer" ng-click="updateMonthConso('QuarterFY',month, selections.manageRollsUpsManually)">
                                                      Q{{lists[month].QuarterFY}}
                                                   </span></h5>
                                             </td>
                                          </tr>
                                       </tbody>
                                    </table>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </auto-height>
            </uib-tab>
            <uib-tab index="2" heading="3. Attributes" ng-click="generateAttributesExamples()">
               <div class="toolbar">
                  <div class="page-title">
                     <h3 translate="TM-Step3Title">
                     </h3>
                     <h5 translate="TM-Step3SubTitle">
                     </h5>
                  </div>
                  <div class="pull-right">
                     <button type="button" class="btn btn-secondary" ng-click="setActiveTab(1)" translate="TM-Step3Previous">:
                     </button>
                     <button type="button" class="btn btn-success" ng-click="setActiveTab(3);generateDimensionInfo()"
                        translate="TM-ReviewAndCreate"></button>
                  </div>
               </div>
               <auto-height>
                  <table class="table table-hover table-sm">
                     <thead>
                        <tr>
                           <th> # </th>
                           <th translate="ATTRIBUTES"> </th>
                           <th translate="TYPE"> </th>
                           <th translate="DESCRIPTION"> </th>
                           <th translate="TM-EXAMPLE"> </th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr ng-repeat="attribute in lists.attributes[selections.dimensionType]">
                           <td>
                              <a href class="click" ng-click="attribute.included = !attribute.included">
                                 <i class="fa fa-toggle-on text-success" ng-if="attribute.included"></i>
                                 <i class="fa fa-toggle-off" ng-if="!attribute.included"></i>
                              </a>
                           </td>
                           <td> <input type="text" class="form-control input-group-prepend" ng-model="attribute.name" />
                           </td>
                           <td>
                              {{attribute.type}}
                           </td>
                           <td>
                              {{attribute.desc}}
                           </td>
                           <td>
                              {{attribute.example}}
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </auto-height>
            </uib-tab>
            <uib-tab index="3" heading="4.Review" ng-click="generateDimensionInfo()">
               <div class="toolbar">
                  <div class="page-title">
                     <h3 translate="TM-Step4Title">
                     </h3>
                     <h5 translate="TM-Step4SubTitle">
                     </h5>
                  </div>
                  <div class="pull-right">
                     <a href="#/dimension/{{instance}}/{{selections.dimensionName}}/{{selections.dimensionName}}" class="btn btn-info"
                        ng-if="createDimensionDone">
                        <span translate="TM-DIMENSIONCREATED"></span>:{{selections.dimensionName}}
                     </a>
                     <button type="button" class="btn btn-secondary" ng-click="setActiveTab(2)" translate="TM-Step4Previous"></button>
                     <button type="button" class="btn btn-success" ng-click="create()" translate="CREATE"></button>
                  </div>
               </div>
               <div class="row">
                  <div class="col-md-12">
                     <div class="alert alert-info" role="alert" ng-if="!dimensionExists">
                        Dimension {{selections.dimensionName}}
                        does not exists yet. Waiting for you to click the Create button...
                     </div>
                     <div class="alert alert-warning" role="alert" ng-if="dimensionExists">
                        <i class="fa fa-fw fa-warning"></i> Dimension
                        <a href="#/dimension/{{instance}}/{{selections.dimensionName}}/{{selections.dimensionName}}">
                           {{selections.dimensionName}}
                        </a> already exists, what do you want to do with leaf elements:
                        <div class="form-check-inline">
                           <div class="radio ml-1">
                              <label class="form-check-label">
                                 <input ng-model="selections.toDoLeafElements" type="radio" name="option1" ng-value="'unwindAllElements'">
                                 Unwind All ELements
                              </label>
                           </div>
                           <div class="radio ml-1">
                              <label class="form-check-label">
                                 <input ng-model="selections.toDoLeafElements" type="radio" name="option2" ng-value="'deleteAllElements'">
                                 Delete All Elements
                              </label>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="row">
                  <div class="col-md-12">
                     <auto-height>
                        <div ng-repeat="hierarchy in dimensionInfo | limitTo:12">
                           <div class="card mb-2">
                              <div class="card-header" style="padding: 5px 10px;">
                                 <label>{{hierarchy.name}}</label>
                                 <span class="pull-right">
                                    <button ng-if="hierarchy.display" class="btn btn-info" title="Hide" ng-click="hierarchy.display=false">
                                       <i class="fa fa-fw fa-eye-slash"></i>
                                    </button>
                                    <button ng-if="!hierarchy.display" class="btn btn-info" title="Show" ng-click="hierarchy.display=true">
                                       <i class="fa fa-fw fa-eye"></i>
                                    </button>
                                 </span>
                              </div>
                              <div class="card-body" ng-if="hierarchy.display">
                                 <table class="table table-hover table-sm">
                                    <thead>
                                       <tr>
                                          <th translate="TM-ELEMENTS"> </th>
                                          <th ng-repeat="attribute in lists.attributes[selections.dimensionType]" ng-if="attribute.included"> {{attribute.name}} </th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                       <tr ng-repeat="elementInfo in hierarchy.elements | limitTo:12">
                                          <td>
                                             <div ng-if="element.name.slice(-2)=='01' && element.name.length==10"
                                                ng-repeat="element in elementInfo">
                                                <div ng-repeat="element in elementInfo">
                                                {{element.name}}
                                             </div>
                                             </div>
                                             <div ng-if="element.name.slice(-2)!='01' && element.name.length==10"
                                                ng-repeat="element in elementInfo">
                                                {{element.name}}
                                             </div>
                                          </td>
                                          <td ng-repeat="attribute in lists.attributes[selections.dimensionType]" ng-if="attribute.included"> 
                                             {{elementInfo[elementInfo.length-1].attributes[$index].value}}
                                          </td>
                                       </tr>
                                    </tbody>
                                 </table>
                              </div>
                           </div>
                        </div>
                     </auto-height>
                  </div>
               </div>
            </uib-tab>
         </uib-tabset>
      </div>
   </div>
</div>